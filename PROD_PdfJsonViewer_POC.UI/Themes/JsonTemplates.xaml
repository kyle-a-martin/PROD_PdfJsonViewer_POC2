<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:local="clr-namespace:PROD_PdfJsonViewer_POC.UI.Controls"
                    xmlns:helper="clr-namespace:PROD_PdfJsonViewer_POC.UI.Helper"
                    >
    <helper:JsonValueConverter x:Key="JsonValueConverter"/>
    
    <!-- Template for displaying JSON Arrays -->
    <DataTemplate x:Key="JsonArrayTemplate">
        <!-- 
        Because JsonArray implements IEnumerable<JsonNode>, 
        we can directly bind to it. 
    -->
        <ItemsControl ItemsSource="{Binding}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Margin="20,2,2,2"
                        BorderBrush="LightGray"
                        BorderThickness="0,0,0,1"
                        Padding="5">
                        <!-- 
                        Each item is a JsonNode. We dispatch it to the 
                        JsonNodeTypeSelector directly here.
                    -->
                        <ContentPresenter
                        Content="{Binding}" 
                        ContentTemplateSelector="{DynamicResource JsonNodeSelector}" />
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </DataTemplate>

    <!-- Template for displaying JSON Objects -->
    <DataTemplate x:Key="JsonObjectTemplate">
        <!-- 
        JsonObject implements IEnumerable<KeyValuePair<string, JsonNode>>. 
    -->
        <ItemsControl ItemsSource="{Binding}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Margin="20,2,2,2"
                        BorderBrush="LightGray"
                        BorderThickness="0,0,0,1"
                        Padding="5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock
                            Text="{Binding Key}"
                            FontWeight="Bold"
                            Margin="0,0,10,0"
                            VerticalAlignment="Center"
                            Height="Auto"/>
                            <!-- 
                            The Value is the actual JsonNode; 
                            again use the selector. 
                        -->
                            <ContentPresenter
                            Content="{Binding Value}"
                            ContentTemplateSelector="{DynamicResource JsonNodeSelector}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </DataTemplate>

    <!-- Template for displaying JSON Values -->
    <DataTemplate x:Key="JsonValueTemplate">
        <TextBox
        Text="{Binding Path=.,
                       Converter={StaticResource JsonValueConverter},
                       Mode=TwoWay,
                       UpdateSourceTrigger=PropertyChanged}"
        TextWrapping="Wrap"
        AcceptsReturn="True"
        MaxWidth="400"
        MinWidth="100"
        IsReadOnly="{Binding IsEditing,
                                 RelativeSource={RelativeSource AncestorType={x:Type local:JsonEditorControl}}}">

            <!-- Optional styling/triggers can go here -->
            <TextBox.Style>
                <Style TargetType="TextBox">
                    <Setter Property="Foreground" Value="#333" />
                    <Setter Property="Background" Value="White" />
                    <Setter Property="Padding" Value="10,5" />
                    <Setter Property="Margin" Value="5" />
                    <Setter Property="BorderBrush" Value="#e0e0e0" />
                    <Setter Property="BorderThickness" Value="1" />
                    <Setter Property="FontFamily" Value="Segoe UI" />
                    <Setter Property="FontSize" Value="14" />
                    <Setter Property="TextWrapping" Value="Wrap" />
                    <Setter Property="AcceptsReturn" Value="True" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsEditing,
                                                    RelativeSource={RelativeSource AncestorType={x:Type local:JsonEditorControl}}}"
                                 Value="True">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="BorderThickness" Value="0"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBox.Style>

        </TextBox>
    </DataTemplate>
</ResourceDictionary>