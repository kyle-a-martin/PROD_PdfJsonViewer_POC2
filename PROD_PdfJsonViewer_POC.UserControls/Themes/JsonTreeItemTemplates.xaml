<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:models="clr-namespace:PROD_PdfJsonViewer_POC.UserControls.Models"
                    xmlns:local="clr-namespace:PROD_PdfJsonViewer_POC.UserControls.Controls"
                    xmlns:converters="clr-namespace:PROD_PdfJsonViewer_POC.UserControls.Converters"
                    xmlns:helper="clr-namespace:PROD_PdfJsonViewer_POC.UserControls.Helper">

    <!-- Built-in converters -->
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    <!-- Inverse of BooleanToVisibilityConverter -->
    <converters:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
    <converters:InverseBooleanConverter x:Key="InverseBooleanConverter" />
    <converters:FilePathToFileNameConverter x:Key="FilePathToFileNameConverter" />


    <!-- Branch Template -->
    <HierarchicalDataTemplate x:Key="BranchTemplate" ItemsSource="{Binding Children}">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <Border Background="Transparent" BorderThickness="0" Padding="5" Margin="0,5">
                <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" />
            </Border>

            <ItemsPresenter Grid.Column="1" Margin="10,0,0,0" />
        </Grid>
    </HierarchicalDataTemplate>

    <!-- Leaf Templates -->
    <DataTemplate x:Key="StringTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" Margin="5" />
            <TextBox Grid.Column="1" Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5" />
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="DateTimeTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" Margin="5" />
            <DatePicker Grid.Column="1" SelectedDate="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5" />
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="BooleanTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" Margin="5" />
            <ToggleButton Grid.Column="1" IsChecked="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Content="{Binding Value}" Margin="5" />
        </Grid>
    </DataTemplate>

    <DataTemplate x:Key="DefaultTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" Margin="5" />
            <TextBlock Grid.Column="1" Text="{Binding Value}" VerticalAlignment="Center" Margin="5" />
        </Grid>
    </DataTemplate>

    <helper:JsonTreeItemTemplateSelector x:Key="JsonTreeItemTemplateSelector"
                                     BranchTemplate="{StaticResource BranchTemplate}"
                                     StringTemplate="{StaticResource StringTemplate}"
                                     DateTimeTemplate="{StaticResource DateTimeTemplate}"
                                     BooleanTemplate="{StaticResource BooleanTemplate}"
                                     DefaultTemplate="{StaticResource DefaultTemplate}" />


    <!-- JSON Editor Item Template -->
    <DataTemplate x:Key="JsonEditorItemTemplate">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Indentation -->
            <Border Background="Transparent" BorderThickness="0" Padding="5,0" Margin="0,5">
                <TextBlock Text="" FontSize="14" VerticalAlignment="Center" />
            </Border>

            <!-- Key and Value -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Key -->
                <TextBlock Text="{Binding Key, StringFormat={}{0}:}" FontWeight="Bold" VerticalAlignment="Center" Margin="5" />

                <!-- Value -->
                <ContentPresenter Grid.Row="1" Content="{Binding}">
                    <ContentPresenter.Resources>
                        <!-- String Template -->
                        <DataTemplate DataType="{x:Type models:JsonTreeItem}" x:Key="StringTemplate">
                            <TextBox Text="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                         AcceptsReturn="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"
                                         MinHeight="30" Margin="5" />
                        </DataTemplate>

                        <!-- DateTime Template -->
                        <DataTemplate DataType="{x:Type models:JsonTreeItem}" x:Key="DateTimeTemplate">
                            <DatePicker SelectedDate="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Margin="5" />
                        </DataTemplate>

                        <!-- Boolean Template -->
                        <DataTemplate DataType="{x:Type models:JsonTreeItem}" x:Key="BooleanTemplate">
                            <ToggleButton IsChecked="{Binding Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Content="{Binding Value}" Margin="5" />
                        </DataTemplate>
                    </ContentPresenter.Resources>
                </ContentPresenter>
            </Grid>
        </Grid>
    </DataTemplate>

    <!-- JSON Editor Branch Template -->
    <DataTemplate x:Key="JsonEditorBranchTemplate">
        <ItemsControl ItemsSource="{Binding Children}" ItemTemplate="{StaticResource JsonEditorItemTemplate}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ItemsControl>
    </DataTemplate>

</ResourceDictionary>